# MM-Radio
Welcome to this project!

The driver code of the BK4802 references [STM32_SIMPLE_CONTROL_BK4802N](https://github.com/BG7QKU/STM32_SIMPLE_CONTROL_BK4802N). Many thanks to the developer [BG7QKU](https://github.com/BG7QKU)!

## Documentation
- [English](README-en.md)
- [中文 (Chinese)](README.md)

## Project Introduction
According to this [report](https://daoinsights.com/news/mcdonalds-releases-retro-walkie-talkie-for-childrens-day-while-kfc-hosts-nostalgic-toy-fair/)
> Recently, McDonald’s kicked off a series of activities ahead of Children’s Day on 1 June, focusing on their classic McNuggets. The fast-food chain launched a special offer of 20 McNuggets for 20 RMB and a variety of limited edition ‘Walkie-Talkie’ toys. The ‘Walkie-Talkie’ is designed in the style of the classic McNuggets and fries. Users can also buy a ‘Walkie-Talkie’ and a graffiti sticker for an additional 38 RMB. On 22 May, the McDonald’s ‘Walkie-Talkie’ toy went on sale, causing the restaurant’s app to crash. While a shop clerk mentioned potential restocking, it’s uncertain if the product will be replenished.

The toy MacNuggets and fries Walkie-Talkies are really cute. They can transmit and receive FM signals at 409.9 MHz.

![](/docs/images/toys.jpg)

I managed to get one on May 22, immediately after McDonald's released the toy offer. I rushed to the nearest store and bought 20 McNuggets so I could be eligible to buy the toys.

As a ham and an engineer, I naturally disassembled them. Then I discovered that the RF IC inside the toy is a BK4802, which can be operated at 430-440MHz. This range covers both local amateur radio FM repeaters, and several well-known satellite FM repeaters, including ARISS, the TEVEL series, and SO-50.

So, an idea came to mind: what if I could modify the firmware of these toy walkie-talkies to make them capable of receiving signals from satellites?

This repository contains everything I modified to make them work. Enjoy! :)

## License
This project is under the [BSD 2-Clause license](./LICENSE).

## Usage
If you don't want to modify the source code, you can use /MDK-ARM/mm/mm.hex directly.

Software like [STM32CubeProgrammer](https://www.st.com/en/development-tools/stm32cubeprog.html) can easily download the hex file to the MCU.

## The Circuit of the Toy Walkie-Talkie
[Circuit of the Toy Walkie-Talkie](./docs/mm-circuit.pdf)

The circuit above may contain errors. Use carefully!

## Wire Connection
![](/docs/images/BoardConnection_en.jpg)
![](/docs/images/SegConnection.jpg)

## Notes for Advanced Developers
Simply use [STM32CubeMX](https://www.st.com/en/development-tools/stm32cubemx.html) to open [mm.ioc](./mm.ioc) if you want to modify or view the pin configuration or source code.

### File Tree of Source Code
* [/Core](./Core/)：All code is auto-generated by STM32CubeMX except for `main.c` and `stm32f0xx_it.c`
    * [main.c](./Core/Src/main.c)：Initialization. Switches the RX frequency in the while loop.
    * [stm32f0xx_it.c](./Core/Src/stm32f0xx_it.c)：Uses SysTick Handler for system scheduling.

* [/Drivers](./Drivers/)：Auto-generated by STM32CubeMX

* [/MDK-ARM](./MDK-ARM/)：Keil UV5 Project Files

* [/Users](./Users/)：Drivers developed by myself.
    * [bk4802.c](./Users/bk4802.c)：Driver code of BK4802
    * [delay.c](./Users/delay.c)：Implement a DelayMS function to precisely delay in milliseconds.
    * [exti.c](./Users/exti.c)：External interrupt settings for the PWR and PTT buttons.
    * [segment_display.c](./Users/segment_display.c)：Driver code of the LED segment display.